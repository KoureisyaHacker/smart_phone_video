<!DOCTYPE html>
<html>
    <!--このページはアプリのホーム画面になる予定-->
    <!--その他のページは'./pages','./css',画像は'./images'に入れてください-->
    <head>
        <meta charset="utf-8">
        <!--マニュフェストファイルの呼び出し-->
        <link rel="manifest" href="./manifest.json">
        
        <title>高齢者向けの動画アプリ</title>

    </head>
    <body>
        <h1>
            <!--この行はテストで入れているので消してよい-->
            高齢者ハッカー
        </h1>
    
        <!--Service Workerの呼び出し-->
        <script type="application/javascript">
            if ('serviceWorker' in navigator) {
              navigator.serviceWorker.getRegistration()
              .then (registration => {
                // 登録中の SW がなければ、これが初回登録である
                const firstRegistration = (registration === undefined);
                // SW を登録する
                navigator.serviceWorker.register('sw.js')
                .then(registration => {
                  // 初回登録でなければ更新が見つかったかチェックする
                  if (!firstRegistration) {
                    registration.addEventListener('updatefound', () => {
                      const installingWorker = registration.installing;
                      if (installingWorker != null) {
                        installingWorker.onstatechange = e => {
                          if (e.target.state == 'installed') {
                            // registration.unregister();  // 効果が疑わしいので保留
                            alert('更新がインストールされました。台本ビューアを再起動してください。');
                          }
                        };
                      }
                    });
                  }
                });
              });
            }
        </script>
    </body>
</html>
